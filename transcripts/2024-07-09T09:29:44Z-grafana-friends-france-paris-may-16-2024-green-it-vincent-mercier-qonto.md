# Grafana &amp; Friends France: Paris, May 16, 2024 | Green IT (Vincent Mercier @ Qonto)

Comment éviter le gaspillage de ressource dans la gestion des infrastructures? (Vincent Mercier @ Qonto) Combien ...

Published on 2024-07-09T09:29:44Z

URL: https://www.youtube.com/watch?v=ZWTcMOhKQjk

Transcript: ant Mercier chez partager un peu les solutions techniquestit peu plus en place au quotidien chez pour réduire un pe au niveau ni un sur moi j'ai aussi passé un petit peu de temps ici sur alternance des juste à côté qu ch c'est franceem ITIE é personnes persones GRSE gr personn on fait tourner centain d'ation mervic sont le cœur système d'information ças par ainormément de sur pour don des chir en production en Sting énor environnement on est sur des volumes qui sont beaucoup plus conséquents sur la partie observability euh grosateur de l'écosystème grafana promus évidment pour tout métrique pour passage à l'échelle euh et on est également utilisateur de l' pour la partie pour toute la partie tracing deééri on est dans dans je crois euh grosse grosse évolution technologique Révolution çaapp la personalisation avec deseur comme c'est incroyable passer d'un serveur physique euh à un serveur qu'on allait vraiment pouvoir utiliser au maximum de ses capacités tout simplement en mettant plusieurs serveurs au seinun même Chassier physique faut vraiment imaginer qu'à cette époque là on avit pizar vous enfiler et en fait pas grandchose 40 % de és des beaucoup plus euh mais cétait la révtion d'époque et c'était déjà une bonne façon finalement d'avoir uneuation efficace deque et just de la en 200 une autre évolution qui VI un tout petit peu plus tard surtout en France en Europe c'est l'arrivée des j'ai plus besoin d'acheter du matériel surpuissant j'ai plus besoin de surallouer de la capacité je pouvoir simplement la consommer à la demande en fonction de l'évolution de mon système d'information c'est une énorme révolution l'autre révolution qui va avec ça c'est commence à voir apparaître les premier système qui vous permet de faire du scaling à la demande on entend souvent parler du Black Friday un gros gros journée d'acé commerce ce genre de techno qui permet concrètement euh de scaler uneinrastructure doubler tripler sa taille sur D temp et ensuite de revenir à des volumes qui sont beaucoup plus avant ça on surdimensionner pour gérer un jour dans l'annéeé 2015 un petit peu plus avant un c'est l'arrivée de tout ce qui va être les principalement [Musique] en Une de cuber avec c'est révolution par du coup on parle plus de serveur plus de machine virtuelle on va vraiment s'adresser au niveau du process au niveau de l'application coup sur ch physiqueation simplement applications surouch et on un peu intermédiaire avait entre auourver dans la [Musique] est dans dans ce modè comment estce que j'ajuste m ressources ressources d'infrastructure BES ré faitz avoirér adistr et puis chaque fois vousz application réguliè temp temps ça très vite un co de blocage entreprise du coup en standard on a de CL scaler qui est un composant qui va communiquer avec les services des cl provider pour scaler génériquement la taille d'un cluster et simpement des de comprendre qu'à chaque fois qu'on va rajouter un de on va rajouter un serveur complet imaginer un technicien qui passé tout à l'heure en train de raccorder un Go équipement qui raccorde à de ça c'est fait on va toujours faire quand je rajoute un serveure Serveur2 alors je suis en train de déployer process en R qui besoin de ça c'est structurellement ce système très difficile à dimensionner et la majorité des cas en fait on va ntoyer s'appelle l'overire désolé son rôlee ement de la ressource au cas où on aurait besoin de avec ce système là grosso modo on passe l'échelle de plusieurs 20 15 minutes à quelques quelques secondes voir c'est énorme et ça veut dire que là on a 50% de notre infrastructure qui est là juste au cas où on aurait besoin de déployer une nouvelle version ou de tout simplementer ça Ctait gr révolution dans c'esti est maintenantorme travail à et diff la derastructure au beso de de l'inrastructure il est capable d'avoir coniss l'applicationou bien mmoire mais il est ai coniss de ce qui en fait mais et en fait ce système il est capable de connaître pr en temp réel des inst che ajuster trouver quel est le meilleur matériel dans beaupation et vous la mettre à disposition euh en temps réel donc là on descend à la minute pour déployer euh une infructure donc ça marche prtiquement pareil déployer l'application euh si vous ça r capacitéu C'est euh une nouvelle application qui nécessite des ressources supplémentaires beaucoup plus malin trouver la B machine à tarif le plus intéressant déjàisation mais il est d'aller encore plus loin puis que même une fois queructure est ntoyé il va continuer à chercher optimiser estce que il y a pas une nouvel serveur qui sera moins cher en ce moment sur lequel on pour çaement on va parler de manifeste vous avez processeur c'est qu chose commécomie d'énergiej énormément en terme defir la plupart desiders on de ressources on pré tourne la vie 40 50 %utilisé et il vous rond à en fait vous allez pouvoir réutiliser des sur de capacité pour travailleur avec des tarifs qui du coup sont de l'ordre de 60 % c'est c'est vraiment pas négligable deè paramètre définir les paramètres de l'UT serveur paramètres réseau les paramètr stockal et cetera conrtement une super déo qui a été fait à rent en fin de l'année dernière il m'agé trois applications qui sont dévolé sur une machine virtuelle TR application 4 g on veut passer à l'échelle on va rajouter dépliement de cette même application parce que on est black friday et on a besoin de de CEER car va n trouver les trois meilleurs n euh les deux par les deux Grau N qui sont au meilleur tarif en ce moment surws qui suler différents applications je pvoir gérer mon et puis lemain euh lemain bah en fait mes dispar appcation dispar du coup j'ai tout de capacité de mon infrastructure et c'est là où la différence avec tous les autes systèmes exist aujourd'hui euh dans l'écosystème c'est qu' va être capable de redimensionner vre infrastructure de retrouver une nouvelle instance qui est plus adaptée à ce moment-là potenellement les instance beaucoupou chercoup et app temp ré vraiment en tant que développeurnie système l'effici et plus à très opérationn ça facite énormément la gestionructure [Musique] pour intéress et effet pour pas spécialement quiut pour syè vousz créer é [Musique] autant on sur la autant ça a permis aussi de découvrir certaines applications qui étaient pas forcément très résilient à là et avant l'incident de production on a pu les détecter sur de [Musique] l'timisation chez nous çaésente quelque chose comme 15 % c'est à évaluer parce qu'on Aure qui évoluenormément beaucoup de croissance juste passage à skeduer beauccoup plus intéressant qui n permett de c'est le Pr ASP deè aspect c'est l' encore une fois prre exemple Black Friday jour dansannéequ vousz d'tivité Auen vous fait pas ch quii différ de la journé coup est coup vousz pouvoir parti ce qu'on prment pour AJ le nombre de déoiement de application pour P gér pense capacité à augmenter service ça Perm aussi d'arrêter les systèmes quand il sont pas util ça c'est beaucoup de mal normal cohérent d'étere des ressources alors ut scaling mais il est basé uniquement sur la mémoire et du C c'est bien mais en fait Pasir grand chose déploy une application Java en fait elle va occuper tout l'espace mmoire que vraiment ça indicateur performance application pas et surtout vous pouvez pas le coup il a autre existe dans l'écosystème C K qui a beaucoup plus flexible parler une cinquantaine deè parle d'analogue pour parler à base de donnéesel pour savoir en temps réel quels sont les les critères pourer parastructure typiquement un qu'on voit souvent c'est les f de message vous avez créé une application qui qui fait des batch de façon asynchrone de [Musique] et ce genre d'outil est capable de vir piloter fait fonction du de message tu vas plus moin pour défer la la ch et là pour c'estveloppeur si vousz pas en place mécanisme pour Don zé vous allez avir un système qui tour jour et nuit dans la vraie vie nous chez S pour faire et du coup le système est un tout petit peu plus complexe on a des applications qui vont consommer publier des messages dans on a une solution prier collecter le nombre de messages de lag et développeur au des applications vont définir pour la base quel est le retard acceptable métier on va déclencher du Sking et [Musique] detion euh moment j'ai plus de 10 messages dans ma ville je vais nployer au fur à mesure des réication pour des pays plus doncquement kppel une autre composant de catis et tout simplement piloter l'utos sceller en disant bah finalement c'esturam c'est pas des moiage plus mal plus fil je connais les métriques de l'application je connais les métriques de l'inrastructure c'est moi qui VI piloter pour te dire quand scale quand don [Musique] scale alors chez nous un jour de Black à ça les de facturation là où on gagne de l'argent cent et donc du coup dans on peut voir que en fait la PL on a un dé mais que ce jourl on a process plus de Patat et donc du coup l' va voir il y a énormément de message dans la FIP et il va ser pour déployant dans réel les applications il y a un risque avec ça c'est l'effet dominance c'est super faire l'aut scaling c'est facile de scaler une application mais il faut vraiment voir le comme une FA globale et notamment vis-à-vis de partieour G c'est assez commun une base de données quand même des hardware assez assez strict vous pouz tout simplement et coda chez et là c'est si vous inignez les limites de ces systèmes là ça que souvent vous allez prendre du retard vous allez prend retard vous allez scaler et comme vous allez encore plus scaler vous allez encore mettre plus de pression sur surti BL et là c'estement dur de sortir de cette situation c'est typiquement unej si vous pas max en général énorme ENIT en système toute votre infrastructure vousz viment la capacité de faire Contin enc de appation par appationsolu et enfin truc euh et probablement le truc le plus actionnable en tant que développeur euh c'est les environments on développement euh la réalité c'est que dans la plupart des entreprises le weekend alors sont par personn et pr et là ilruction vraiment extrêmement magique mais extrêmement efficace s'appelle CIN un opérateur pour t seul rôle lui c'est deétendre vos systèmes qui sont c'est c'est tout B le vendredi quand vous l'école ou probement VT et vous revenez Lund matin pour pour euh faire exactement la même chose vous définissez dans votre application ques sont les règles pour l'teindre le vendredi soir à 20h pass le à zé et il c'est vraiment de configuration mais c'est extrêmement efficace FO dans votre objet simplement dire qu'est-ce que j'arrête déploement quand est-ce que je les arrête les arrêt le vendredi soir le lundi soir éventuellement qu son les systèm je veux pas arrêter peut-être des systèmes comme V système de BUP votre base de données système deing arrê et du coup pour installer tout ça c'est TR minut qui sont là installer opérateur et juste appliquer votre configuration extrêmement basique c'est pr job fait un de serveur mais le le plus dur je pense c'est barè psychologique très trè durexquerv arr systè presque du bon sens au niau c'est limité pour au déploiement niveau ressources ça va changer là dans les prochaines semaines et petite subtilité euh là on est en train de rajouter plein de composants qui vont venir piloter dyiquement entre l'ut qui va arrêter applicationi qui va faire du déploiement continu systè et donc du coup vous pouvez avoir des conflits plusieurs s marcher dessus en fait moi je un a un tout petit peu de paramétrage vous pouvez avoir notamment si vous utilisez comme flux pourah préir les informer que sur certain de temps c'est pas eux qui vont piloter l'Infra il y a d'autres systèmes qui vont donc chez nous ça ressemble à ça une journée type on démarre les infrastructure vers 7h du matin on passe de 3 4000 conteneurs à 12000 en euh et on éteint tout la nuit directement pour alors malheureusement onarrive pas à tout à zé mais imag du coup avant on à toute la journée finement avec leement dé sur le site Cu un petit calculateur CO2 juger la des calculs mais ça Perm déjàévaluer plus votrerastructure est grande plus ê systme in [Musique] quelques takeaon a normalement des développeurs ici le prier développer des applications son ça paraî B mais en fait V appation peut pas êt arrêé équip vousmême pas en mesure Depp tout ce qu'on prdment c'est deèuer la pertinence faire du batchaming le batch on a vu que ça nécessite de SC des infrastructures très rapidement euh et à l'inersing vous avez un démon tris messages par jource est-ce que si pertinent de laiss tour journ deuxème aussi aut élément c'est l'ation mémoire mémoire c'est le challenge le plus compqué en terme d'ure c'est ça a déterminer la taille des machines serveurs mettre en place un moyen assez efficace en terme de développement c'est bah de réduire mmoire en utilisant des langages compidés vra différence entre les langages ou r parfois on est simpleou voir parfois fois la mmoire pour le même service on est en train parfois de recoser des services aussi dans l'ARE truc et ça c'est plus subtile je pense que pour ceux qui sont encore étudiants ça va vous prendre quelques années pour le voir BES et rcture éid j'espère si vous fait ça va drasement changer la faç desrruct allez mettre automatique vous allez opis en [Musique] perman et ça access ch très bire en Go que ce soit de laamd ou de la r c'est une option de compilation par contre vous gagnez 30 % d'économie VO 60 % en TER d'énergie les l' ça c'est des choses qui sont à travailler entre développeur et de l'infrastructure essayer de desruct ça para peu extrêmement mais ça marche etquer les ressources surisionnées c'est un travail à faire régulièrement évaluer la consommation mémoire en tant que développeur c'est extrêmement difficile hein de savoir dire combien de mémoire utilisé par votre application Web vre back API et cet mais c'est c'est la guerre en fait infra pour dimensionner des de l'URE vous quelques petites préférences vous pour les lire à l'occasion côté CNCF il y a pas mal de d'initiatives aussi qui sont faites côté environnemental technique euh assez àez sujet P euhci je pense vous AZ peut-être une question déjà euh euh ou tu disais là le tout dernier c'était hyper difficile de traquer combienont consommer une apppplication et cetera il y a des outils qui sont qui ont été faitutilise nous commeox qui permet de d'essayer d'observer du pod sur CTIS pour traquer combien à combien ils monent en mémoire combien ils consomme en CPU sur une plage de temps àin de donneré des manifest quoi de tes applications et ça seilleace par space pareil c'est hyper intéress les quand [Musique] tu ce qui difficile à faire en entreprise c'est de ramenerette information déjà développeur et enant développeur est les ressources nécessaires pour faireour mon et en dans un quotidienvelur en entreprise du temps pour faire la simulation c'esteng plus organisation technique rctureile [Musique]

