# Grafana Cloudによるアプリケーションとインフラの統合オブザーバビリティでトラブルシューティングを高速化

Published on 2025-10-24T17:10:41Z

## Description

ObservabilityCON 2023では、アサートの取得を発表しました。これにより、テレメトリデータに知識レイヤーを追加し、 ...

URL: https://www.youtube.com/watch?v=qaKuFnuRoDU

## Summary

このYouTubeビデオでは、グラファラブズのソリューションエンジニア、アルフレードが登壇し、トラブルシューティングを迅速化するための「アサート」というツールの利点について説明しています。アルフレードは、エンジニアがトラブルシューティングの際に直面する課題を具体的なシナリオを通じて紹介し、アサートが自動的に原因分析を行い、関連情報を一元化することで問題解決のスピードを向上させる方法を示しています。ビデオでは、アラートの受信から問題解決までのプロセスをデモを交えて説明し、アサートがいかにしてエンジニアの負担を軽減し、ビジネスの損失を防ぐかに焦点を当てています。また、アサートの導入方法や活用事例についても言及されており、最終的にはエンジニアのイノベーションに費やす時間を増やすことができると結論づけています。

## Chapters

00:00:00 イントロダクションと自己紹介  
00:01:30 トラブルシューティングの重要性について  
00:03:00 グループアクティビティの開始  
00:05:00 トラブルシューティングの実際のシナリオを紹介  
00:07:30 ダッシュボードの確認とエラーの発見  
00:10:00 アーキテクチャダイアグラムの重要性  
00:12:30 データベースダッシュボードの確認  
00:15:00 アサートを用いた自動的な原因分析の紹介  
00:20:00 デモンストレーションの開始  
00:25:00 アサートの効果と顧客の声について  
00:30:00 アサートの導入方法と利点の説明  

# グラファクラウドによるトラブルシューティングの加速

皆さん、こんにちは。EXbeの皆さん、今日こちらに参加できて嬉しく思っています。私のスピーチは英語で行います。アルフレードと申します。スタッフソリューションエンジニアとしてグラファラブズで仕事をしています。この機会をいただけて本当に嬉しく思っています。

今回は、グラファクラウドがどのようにトラブルシューティングを高速化し、オペレーション上の問題を解決できるのかについてお話ししたいと思います。

## 質問コーナー

これまでのセッションと同様に、何かご質問がありましたらこちらのQRコードから質問をお願いします。お時間があればできるだけご回答しますし、外におりますので、「アスクエクスパート」のコーナーで何かありましたら私にお声かけください。

それでは、まず質問から始めましょう。これまでトラブルアプリケーションやインフラストラクチャーのトラブルシュートを定期的に行っていらっしゃる方は手を挙げてください。

（多くの方が手を挙げる）

では、皆様の中でトラブルシューティングには時間がかかったり、フラストレーションが溜まるといった経験のある方はいらっしゃいますか？ダッシュボードをチェックしたり、ログを確認したり、ドキュメントを見るものの、答えがクリアではないという状況はありませんか？

## トラブルシューティングのシナリオ

次に、グループアクティビティのような形で考えてみましょう。今ここに私はエンジニアとしていて、オンラインストアのエンジニアだと仮定します。今日、今週はオンコールのシフトで、ナーバスになっています。会社には2ヶ月前に入社したばかりで、上司は周りにいない状況です。午前1時、寝ようとしていますが、電話が鳴ります。スクリーンを見るとアラートが出ています。

サーチプロダクトのSLが高いとのこと。このサービスをお客様が使っているのですが、スピードがすごく遅いのです。そこで、私はベッドから起き上がり、ラップトップを立ち上げて調査を始めます。

最初にチェックするのはフロントエンドのダッシュボードです。上司が問題があったら見るように教えてくれたダッシュボードです。見ると、色々なところに赤が出ています。赤は悪いことを示しています。フロントエンドにエラーが出ていて、お客様は我々のプロダクトをブラウジングできず、購入もできない状況です。ビジネスとしては損失です。

上司に知らせ、私も分析を行って問題解決に当たる必要があります。エラーのうちの1つを確認しましたが、500件のエラーがプロダクトAPIに生じています。さらに追加のエラーをクリックすると、同じ状況です。

次に、バックエンドサービスがどういったものを使っているのかを理解しなければなりません。おそらくプロダクトサービスではないでしょうか。しかし、具体的にこのサービスがどこと通信しているのか、どこと繋がっているのかは全く分かりません。

そこで、思いつきます。シニアが言っていたアーキテクチャダイヤグラムを探してみることにしました。そのダイヤグラムには接続の様式が書いてあります。コンフルエンスのデータを見ますが、数ヶ月前の情報です。開発者はリリースが早いので、このデータが最新なのか分かりません。

ダッシュボードを確認し、サービスの正しいダッシュボードを確認しなければなりません。しかし、答えは見つかりません。損失がどんどん出てきており、私がこのままだと仕事を失ってしまいます。

次にポストグレスのダッシュボードを確認しますが、どのインスタンスを見ればいいのか分かりません。このままだと仕事を失ってしまいます。問題が解決できません。

エンジニアであれば誰でも、特に新しい人はこういった状況に直面することがあります。いろんなデータはあっても、インシデントがあった時に正しいデータを見つけるのは本当に難しいのです。アラートがたくさん出ていて、ノイズも多く、インサイトがノイズに埋もれてしまうのです。ビジネスとしても損失が重なります。

ここでアサートが役に立ちます。アサートは文脈的な自動的原因分析を提供し、トラブルシューティングを加速化させてくれます。

## アサートの機能

アサートは以下の3つのことを行います。

1. **検出**: アサートは皆様の指標を確認し、アプリケーションのメトリックスやオープンテレメトリーを見て、環境内のサービスや依存関係を確認します。

2. **関連付け**: 関連するマトリクスをエンティティと関連付け、健全な状況を理解します。

3. **ハイライト**: 主要なシグナルをハイライトし、トラブルシューティングで重要なシグナルを示します。セーフモデルが設定されており、急上昇が見られた場合にはトラブルシューターに通知が来ます。

ここで、仮説的な状況を考えてみましょう。午前1時、アラートが出てきます。アサートがあることで、どのように調査が異なる形で行えるか見ていきましょう。

## デモ

デモを始めます。この部屋で午前1時、アラートが来ました。サーチプロダクトのCSが高いというアラートです。お客様が我々のプロダクトをブラウズできないので、急いで問題を解決しなければなりません。

アラートを調査すると、複数のダッシュボードを行き来せずに、ヒートマップが出てきます。ここでそれぞれのセーフモデルが分類されています。赤がクリティカル、黄色はウォーニング、青は情報提供です。

サマリーに移ると、このイベントの自系列的な順序が示されます。関連するサービスが分かり、フロントエンドとレコメンデーションサービスのつながりが示されます。ここで仮説を立てられるのです。

このフィーチャーフラグステートが変わるかもしれず、問題がサービスに残っていることが示されています。フィーチャーフラグを確認すると、誰かがプロダクトカタログをポストグレスからイネイブルしたことが分かります。

ポストグレスのオーバービットが表示され、リクエストの数やコネクション状況も分かります。ポストグレスはこのようなハイコネクション向けに設定されていないようです。これをデータベースのアドミニストレーションと共有し、調査を行います。

結果的に、プロダクトカタログサービスにもエラーが発生しており、全てが問題ないことを確認します。最終的にはデータベースのアドミニストレーターに情報を共有し、問題を解決します。

## まとめ

アラートの分析から解決までに約5分かかりました。復習すると、アサートは関連するメトリックスを関連付け、健全性を特定し、シグナルをハイライトします。グラファファミリーに入ってから1年ほどが経ち、アサートで様々な部分を手掛けてきました。今、皆様にご利用いただける準備が整いました。

これからもアサートを通じてトラブルシューティングを効率化し、睡眠時間を確保できるようにしていきましょう。アサートによって分析とトラブルシューティングのスピードが向上し、推測する必要がなくなります。具体的なユースケースを見ていくと、アサートがどのように役立つかが明らかになります。

私たちの目標は、グラファクラウドを通じて全てのアプリ、インフラデータを提供し、より迅速なトラブルシューティングを実現することです。

## Raw YouTube Transcript

[拍手] 京の皆さん こんにちはEXbe今日 はこちらに参加できて嬉しく思っています えスピーチは英語でさせていただければと 思いますアルフレードと申しますスタッフ ソリューションエンジニアとしてグラファ ラブズで仕事をしています本当にこの機会 をいただけで嬉しく思っていますグラファ なクラウドがどのようにトラブル シューティングを高速化しオペレーション 上のえ何点を解決できるのかお話できれば と思っていますこれまでのセッションと 同様に何かご質問がありましたらこちらの QRコードからえ質問をお願いしますお 時間があればできるだけご回答しますし あとは外におりますのでえ我アスク エクスパートのコーナーで何かありまし たら私にお声かけ くださいそれでは質問から始めましょう でこれまでトラブルアプリケーションだっ たりインフラストラクチャーのトラブル シュートを定期的に行ってらっしゃる方 教師お願いしますかなりそうですねま かなりの方々ですねではどうでしょうか皆 様の中でトラブルシューティングには時間 がかかったりフラストレーションが溜まる とそういう経験のある方ダッシュボードを チェックされてログを確認して ドキュメントを見るとえでも答えはクリア ではないとそういう状況はないでしょうか 今日次にしたいのはまグループ アクティビティような形なんですけれども こう考えてみてください今ここに私がいて 私はエンジニアオンラインストア会社の エンジニアだとしましょう私がで今日今週 私はオンコールのシフトで私はナーバス です会社には2ヶ月前にえ入社したばかり ですえそしてえ上司は周りにいないとも 北海道だったりでをしてるわけです司はな ので私は ですでナーバス ですで今午前1時 です今午前1時だと仮定してきてください 寝ようとしていますでも電話がなり ますええそしてスクリーンを見ますと アラードが出ていますえスクリーンを しっかりと目を凝らしてみますま文字が 小さいのでしっかり見えますえサーチ プロダクトのSLの高いとよくないですね このサービスをお客様使ってプロダクトの ブラウズをされているわけですねそして今 そのスピードがすごく遅いわけですなので 私はえベッドから起き上がってラプトップ を立ち上げまして調査を始めますで最初に 何をチェックするかと言うとこのフロント エンドのダッシュボードになります私の 上司たちが問題があったら見るように私に 教えてくれたそのダッシュボードですなで 見るとダッシュボード見ると色々赤が出て きます赤は悪いことを示しています いろんなところにエラーが出ていて フロントエンドにエラーが出ていてお客様 は我々のプロダクトのブラウジングができ ない購入ができないつまりビジネスとして は損失です1分失われるとえ損失も出る わけです上司に知らせ ますそして私も分析を行って問題解決に 当たる必要がありますエラーのうちの1つ を確認しましたどうなってるかというと 500件のエラーがプロダクトAPIに 生じていますいくつかまた追加でエラーを クリックしてみますと同じ状況 ですで次にここで理解しないといけないの がバックエンドサービスはどういったもの が使えているのかおそらくプロダクト サービスじゃないでしょうかでも他には 何か関係してるでしょうかでも具体的に このサービスがどことえ通信をしてるのか どこと繋がってるのかそういったことは 全く分かっていませ んそこで 私思いつきますあよかったえシニアが確か 言ってたよな とオンボーディングの時にえ上司が言って いたチームがこのアーキテクチャ ダイヤグラムを作ってるんだったとそう いう話をしてるのを思い出したとそこに アーキテクチャーの接続の様式が書いて あると思い出しましたなのでこの コンフルエンスのデータを見ます え数ヶ月前の話だったんですね上司が言っ てたのはそしてデベロッパーだったりただ デベロッパーというのはリリースが早いの でこのデータが最新なのか分からないわけ ですダッシュボードを見た見ていろんな サービスのその正しいダッシュボードを 確認しないといけないわけですけれど もまずサービスダッシュボードを確認し ます1つ見て次のダッシュボードを見るで も答えは見つかりませんえそしてお金が どんどんえなくなっていきます損失が出て きています私がこのままだと仕事を失って しまいます次にポストグレス ダッシュボードを確認をしますこれを見る べきかな と考えてそしてダッシュボードを見ます がでもこれは何なのかとこれどの インスタントを見ればいいのか分かりませ んまこのままだと仕事を失ってしまいます 問題が解決できませんでここで私が経験し てることはこれはエンジニア誰であっても ま新しい人でも誰であってもこういう状況 というのはあるわけあるべきですあるわけ ですいろんなデータはあっても インシデントがあった時に正しいデータを 見つけるということが本当に難しいん ですいろんなアラートが出ていてそして ノイズも多いえそうなるとインサイトが ノイズに埋もれてしまうわけですそうなる とビジネスとしても損失がが重んでしまう わけ ですここでアサートが役に立つわけですね アサートというのは文脈的な自動的な原因 分析を提供しトラブルシュートを加速化さ せてくれますでここでアサートは3つやっ てくれます1つ目が検出ですアサートは皆 様の指標を確認をしてえそのキューブ ステイトえマトリックスだったりを確認を してどのようなノノドやポッだったりが 環境にあるのか確認をしアプリケーション マトリックスだったりえオープン テレメトリーだったりを見てランニング サービスだったりえその環境内の使われて いるサービスだったりあるいは依存関係 だったりを確認をしますデータを送ったら サービスグラフメトリックスからデータを トレースからえサービス名刺の情報だっ たら送ったりとその関係性こういった状況 をがグラフデータベースに示しているわけ でそれがこのような形で表示されるわけ ですこれがポッドの1ですポッドのパート 11つ目の検出です2つ目が関連付けです 関連するマトリクスをえそのエンティティ だったりと関連付けてそして健全な状況は 何なのかを理解をしめるわけです次に ハイライトを行いますつに主要なシグナル トラブルシューティングで重な重要な シグナルのハイライトを行いますえこの システムの中に えセーフモデルというものが設定されてい ますセーフモデルというのは サチュレーション アノマリーそしてアメンドメントフリア エラーそれを表すセフSAFEモデルです ね 例えばクリティカルサービスにおいてその データの急上昇が見られた場合には トラブルシューターである我々に連絡が 来るわけですはすぐにえそのゲスすること なく原因に簡単に行きつくことができます では仮説的なえその状況を考えてみ ましょうえ1時午前1時寝たいわけですね バラートが出てきますじゃあどのように アサートがあることによって調査をどの ように異なる形で行うことができる でしょうかここでではデモをお見せしたい と思い ますはいではデモ始めてください この部屋今朝1時ですこのアラートが来 ましたサーチプロダクトえ0.CSえバ レートが高いとお客様我々のプロダクトを ブラウズできないので私から急いでこの 問題を解決しなければなりませんこれが私 の役割ですのでこの問題を解決したい そしてえ会社がの経費も削減したいし そして私もこの後睡眠を少し確保したいと 思うわけですそれではまずこれを見てみ ましょうこの アラートアラートがまずは調査という形で 教えてくれてるのでここを見てみますこの バッチを見ますここ で複数のダッシュボードを行きしなくても このヒートマップこの関連システムの アサーションのヒートマップが出てきます のでえここでそれぞれセーフモデル サチュレーションセーフモデルアメンド アノマリーフェリアそしてエラーという形 で分類されていますそれカラコーディング されていますでレッドがクリティカル黄色 はウォーニング青はこれは インフォメーション情報提供ということに なりますそれではこれを拡大してみます何 を伝えようとしてるのかではサマリーに 参り ますこれはスコア別に分類するのではなく てこれをタイプ別に分類し ますこれはえこのイベントの自系列的な 順序ですですので何か私の きこれをその様々この下で色々起きている と追加的なえメンションスペース空間を 加えてこのグラフビューをクリックします する とその 連関係したサービスが分かりますフロント エンドとこれが私のレコメンデーション サービスとつがっているプロカタログ プロダクカタログコネクトがプッシュ グレスデータベースにつがって このような自系列によってそしてこの スペース空間の次元によっ てこの時間軸え情報がアップデートされ ますえですのでここで仮説を立てられるん ですこのフィーチャーフラッグステート この状態は変わるかもしれないそしてどう やらこの問題えこれがこのえサービスの ところで問題が残っているということで もう段深掘りをしますこのフィーチャー フレックスを見ると何が変わった か誰かがこのプロダクトカタログを ポストグレスからイネイブルしたと誰が イネイブルしたか分からないが興味深い 情報ですこれエネイブルした時に ポストグレスデータベースがまだ準備が 整っていなかったショックを受けて コネクションが多すぎたということですね え予想を不まるコネクションが起き たそれでは他にどういった情報 ポストグレスから教えてくれるのかKPI ドラーをクリックしてするとこの ポストグレスの オーバービットがこのようにプレされます のでリクエストの数も分かるしはい コネクションがありますねハイキャッシュ ヒートレージもあれ興味深い情報です ポストグレスはこのようなハイ コネクション向けに設定されていないよう ですのでこれをリンクをコピーし て調査の後に私のデーベースの アドミニストレーションと共有できるよう にしておきます先ほどのグラフでの仮説 はポストグレスデータベース これがプロダクトカタログサービスに コネクト接続していますプロダクト カタログサービスにもエラーがあっ てQPクラッシングにつがっているですの でまずこのサービスを調査して全て大丈夫 とプロダクトカタログの観点からも問題 ないこと確認したいと思いますですので 同じようにKPIVIを開き ます必要な情報が表示されます アプリケーションから始まってます ゴールデン シグナルデュレーション0.Cエラー レートアウトバウンドオペレーションイン バウンドハイエラー などではここでキュポ プレッシャえこれはメモリーを見る とクネスでメモリーの使用率そして上限が 問題ないよう ですまだまだ余地が多いと分かり ますそれでは次に1段深掘りをしてログを 見てみますスタンダードログサービサーの ログこの赤い色は何でしょう か申し訳ないクライアントがもうすでに多 すぎると書いてありますね分かりましたと まずは 謝罪を 受け入れるえではシナリオ続けます クライエントが多すぎるということですね クラントエラーが多いプロダクトカタログ サービスでは問題はないけれどもこれは ダウンストリームのプロストグラスデスの 下流のダウンスリームの問題のようですで はここで起きたこと は誰かがフィーチャフラグをエネイブルし たんですねそポーストグレスまだ準備が 整っていなかったそしてこのような コネクションハイコネクションが起きたの でプロダクトカタログサービスにエラーが 起きたんです他にもえプロダクトカタログ にレコメンデーションサービスフロント エンドサービスなど依存しているサービス が他にあるのでこの問題がカスケード ダウンされると他のサービサーにも カスケードダウンされるということですで はここでフィーチャーを 変更データベースアドミニストレーターに えコピーしてポストグレスデータ ダッシュボードからコピーして共有をし ます彼に見てもらいます で自分の私はまた睡眠に戻れると5分 ぐらいでできるでしょうかアラートがの 分析 から解決まで5分ぐらいでしょうかかなり いいですよ ねということで復習です がー コンティそしてその電子をまずは解明して それからこの関係する メトリックスをえ関連付けてそしてそれら の健全性を特定するそれからそのRCAの ワークメンチでシグナルをハイライト する何かが間違っている場合どこを見れば いいか教えてくれるん ですえ冒頭で申し上げましたようにそして トムさんおっしゃったようにグラファ ファミリーで私も1年ほど前に入って チームが力しアサート でグラファクラウドで様々な部分手掛け そして今皆様にお使いいただける準備が 整いまし たクバネティスのモニタリングと統合さ れアプリケーションのプロクシティえなど など統合されていますこれからも増え ますここで目標としているのがこれを グラファクラウドを全てにつげるという ことですアートを投するということです まこのトラブルシューティ早いと申し上げ ましたえこの自動化されたコリレーション 相あるいは分析など提供してくれると全て のアプリインフラデータで提供してくれる とえそして仕事も失うこともないし睡眠が けられることもないしという話をしました が次にお話したいのがアサート がどのようにその実生活における カスタマーを支援できるかということ ですこちらブクロ私たちのお客様の言葉 ですアサートは分析とトラブル シューティングのスピードを除させるのに 役立つと書いてあり ますアサートによってあらゆる情報の相関 分析を行うことが できるもはや推測をする必要はないと言っ ていますでは具体的なユスケースを見て いきましょうえデモの文脈ですけれども エンジニアリンググループが えその投資運用プラットフォームを管理し ていますそしてそれをホストサービスとし て管理していますあらゆる種類の資産運用 をトレーディングだったり コンプライアンスだったりポートフォリオ マネージメントだったりがえ対象となって いますアサートとして理解しないといけ ないのがまアサートは既存のマトリックス とどうえ採用するのかということです そして新しいインサイトアサートがどう 提供するのかということです 今の状況だとそういったインサイトを得る のは難しいですなので彼らのアサートの ある前の導入前のワークフローはこういう ものです何か問題があるとオペレーターが アラートを受け取りますトレーディングの スピードが遅いだたりのアラートを 受け取ってそしてランブを参照します そしてトレーディングのどの分野に問題が あるのかを確認をします最終的に彼らが 発見するのは問題があるのは コンプライアンスワークブックにに問題が あると分かるわけですねそして ダッシュボード彼らはチェックします様々 なコンプライアンスサービスの ダッシュボードをチェックしますログも チェックしそしてトランザクションID だったりを1つからまた別へとコピーして スペースしてということを行いますそう することでトラブルシュートを進めること ができますでこちらをご覧いただきますと 必要なのはオペレーターがしっかり としっかりと様々なえそのえワークフロー を理解するということですでも オペレーターが新人だとどうでしょうか私 のように新人で2ヶ月前に入社した社員だ とどうでしょうかオンコールでシニアな 先輩がま休みだったらどうでしょう新人が 1人だったらどうでしょうかここで アサートが物事を様変わりさせてくれます アラートが出たとしてランブックが古かっ たとしましてもライブビューでアサート エンティティグラフを通じまして状況を 示してくれますトレーディングセグメント をにフォーカスできるような形で見せて くれ ますこれプロジェクターの問題でなくて わざとぼやかしていますちなみにこの ワークベンチを使うことでその アサーション のえその優先順位付けを行いますこの アサーションを使うことで様々な接続され たサービスをえその示し問題も同時にえ 特定できるかもしれませんRCよりもより 早いですアサートというのはあらゆる関連 した情報を1箇所に示すことができるから ですそして大切なのは時間です全ての1分 がも重要です遅れが出てくれば調査が遅れ たらそれだけ事業は損失を被るということ になりますの でつまりこういうことです1つ目にえ解決 までの時間を削減できるということです アサートが使われるとそしてアラート疲れ を軽減できるとそしてイノベーションに 使える時間が増えるということです問題 集成だけではなくて問題修正ではなくて 新しいリリースのためのイノベーションに 時間を使えるようになるという効果があり ますではアサートをどう導入し使い始めれ ばいいでしょうかアサートというのは グラファなクラウドアドバンスカスタマー を客できますそしてオブザーバ アプリケーションオブザーバビリティを 使うこと でえクバネティスモニタリングと アプリケーションビリティを使い ますえ そして複数のシステムのデータを 組み合わせることができましてそして リッチなえシグナルをえその生成してえ 表示することができるそういった機能が アサートにはあります

