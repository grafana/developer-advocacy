# Data Management &amp; Monitoring at The National Library of the Netherlands | GrafanaCON 2024 | Grafana

To secure its mission to preserve and provide Dutch literature for the digital age, The National Library of the Netherlands made a ...

Published on 2024-04-25T23:59:34Z

URL: https://www.youtube.com/watch?v=tICGNIIW-n8

Transcript: welcome to the afternoon session I hope you're well fed everyone uh if you did not get to try the the dessert uh try and get some later it's really nice anyway um we are going to start with one of the topics which I really like because uh software is nice and everything but um now we are going to hear about something which like actually matters for Humanity like safekeeping information for for future generations and without much further Ado over to herland sorry [Applause] does it work yeah okay so uh welcome everybody uh hope you had a nice lunch I'll try to be uh not so boring so you all uh have after dinner dip my name is k f Anga I'm a devops platform engineer uh been working in it for 10 years uh currently working um at the National Library of the Netherlands uh on a platform to store the Dutch literature probably break my tongue on that word lots of times but I'll try to do my best um so what is the National Library of the Netherlands the National Library of the Netherlands is a semi-government organization that has three basic roles it's to preserve the Dutch literature so we have uh documents dating back to the 1600s and on a daily base we process um all kinds of literature like uh scientific papers books adult literature uh that sort of stuff there's actually a fun fact about the adult literature uh we store that in a fault because it gets stolen a lot of time so always a good one uh the second role is doing research so um there are multiple organizations in the Netherlands that use the Dutch Library uh for research purposes one of the I think most uh well one of the examples is that in the Second World War uh there were a lot of airplanes going down in Asia with the Dutch uh uh soldiers in it and using linguistic research uh on the Dutch newspapers that were produced in uh Indonesia they were able to uh find soldiers that washed up a Shore and then they could uh uh inform the next of K that their uh family was there uh was found somewhere in Indonesia for example and that was the the research was done a couple of years ago so you could see that even after well 80 years uh literature still adds value to uh humanity and the last one is to connect people around the world but mainly in the Netherlands by making the Dutch literature available uh in a digital way uh but also in a physical way um and uh I want to share a couple of numbers uh toh show how impressive uh the National Library is but to be honest yesterday I attended the CERN talk and um he presented other numbers and it was like okay these are rookie numbers but still um one thing we got the CERN on is the particle accelerator is only 22 km long and we got 120 kilm of books so got you there but uh we store three and a half petabytes of digital uh literature uh and it's growing with 300 to 400 terabytes a year so uh I uh estimated a bit low but let's be optimistic and we have uh literature are dating back 406 years and we make it available 24/7 so one of the examples that we uh have to make this literature available is this website you can visit it it's uh del. NL and uh it's a website where you can go and you can type uh any word name that you want and if it's uh somewhere in a newspaper or in one of the digital assets that we have uh it will be presented to you so this is one of the um well lightweight examples well the application is not lightweight but lightweight examples that we have uh to uh um connect people through uh literature um so this is just one of the examples that we have we have also uh more digital apps that process all of our books that store it so you can imagine that with all these data that we have that um there's a lot of it going on in this organization that might at first look like uh an old and boring company but it's not and uh we um we started uh our observability journey last year and um I want to uh take you with me on the journey why observability is important for uh um an Institute like the National Library so why do you do observability well uh first it's just the law we are legally obligated to store logs for uh well a minimum of six months depending on what kind of application uh we use so uh currently we're doing this on the server itself but it's hard to keep the retention times uh correct so we wanted to use use observability to um yeah to obey the law uh basically um also we want to provide an excellent customer experience I think uh we all write software to solve a problem and if the problem is not solved the software is not working and if you if you don't know that your software is not working how how um how can you then act upon it right um next is we want to be able to steer on realtime information if you're St if you're storing a lot of information you want to be able to um make analysis and uh plan your expenditures so uh in the case of the de Library we are expanding our uh storage a lot of times and you want to be able to plan that up front and observability helps us uh with that question and last but not least because dashboards look cool we all uh know these uh big screens uh in operation rooms where dashboards go uh up and down I think it looks cool and uh we want to have things that look cool right so we started off with some basic requirements this uh is not an exhaustive list but this is a list of some of the things that we took in consideration when starting our observability journey um well we want to have metrics because we want to know how our application is performing we want to have log retention because it's the law uh we want to be able to do a simple analytics on our logs because just plain logs is uh hard to go through um because we're a government organization we are um a bit well anti Cloud well it's not that we're anti- Cloud but cloud is uh sometimes a bit difficult in government organizations because uh um the process the tenders are take a long time and are expensive so uh if we can do it on Prem we want to do it on Prem uh our service should be high available and it should be easy to use so we took these very well rudimentary requirements and started to do a comparison so um it's uh grafana versus Splunk but we also look at other tools um I put Splunk up here because uh the National Library was using Splunk before we started uh the observability journey um most of the things that we could do with Splunk we could also do with grafana but in the end uh we looked at these uh attributes and we came up with grafana for being number one and uh uh one well one of the things for grafana was that it was really easy to use for the developers so once you get your infrastructure rolled out the uh developer experience is pretty easy but I think most of the people that are using grafana probably already know this but the one of the other things uh is that um it meant a cost reduction of nearly 80,000 EUR a year so that's a that's a nice one for uh for the Opex um and there are other um yeah prior um there were other benefits like uh the gravana tech really supports almost every question that we had so after making the decision to go for gravana we started to focus on uh on the well on one part of the software delivery life cycle I actually sto this from the slide deck that I got from ganet I didn't change anything but but it um it it shows what we were doing so we wanted uh to enable the teams to be able to support the part of this software delivery life cycle after deployment um and therefore we um created our own grafana landscape and I'll try to explain a bit what we did here so first of all we deployed two uh grafana Surfers on on bare metal VMS with a post Crest database behind it um and then uh behind that we deployed three mimir uh applications and three Loki uh applications um both running in monolitic mode I'll tell a little bit about that uh on later slides and then for all the applications that are running on Virtual uh machines uh in our landscape we installed the Carana agent which scrapes the logs and then scrapes the Prometheus endpoints and puts those metrics and logs into the yeah into Loki and into M um and to be able to do this we use anible so we created um our own anible collection um which rolls out the gravana uh server the grafana agent Loki and mimir um and we want wanted to do this to take away the pain for other development teams um in rolling out uh this yeah this landscape they don't need to be bothered with it but what we really wanted to achieve was uh ease of use for all of our developers so um actually the only thing that you need to do if you have this is configure your gravana agent to um to scrape the right things and um while Gana agent is relatively simple you have to do some configuration and um if you use anible you can do some templating but if you don't use templating the configuration will look something like this without a variables um it's actually a lot easier than it looks um but we also we were thinking this is maybe a bit too techn well not too technical but it's a bit too technical for our developers so we wanted to make it easy for the developers to use so we templated this out and actually the only thing that they need to do when uh defining their infrastructure as code is uh Define a variable with an app name and a port number and then they're good to go so everything else is rolled out automatically so if a team wants to start using our grafana landscape two variables and then they're good to go once we did that we uh created uh two basic dashboards um and actually this is a standard dashboard from the gravana library which was created for uh yaava spring boot apps in kubernetes but we did a little bit of uh fine-tuning to make it work for our uh for our Hardware infrastructure and basically the teams that uh opt in for uh monitoring they uh they can go to this dashboard they can select their application which server uh the life cycle environment they can select their team and uh or one of those variables and then the uh dashboard will show them all the relevant data that is needed to maintain U spring boot app so then this one dashboard there it provides ins ites in your uh application metrics but there's also logs and uh we created a separate dashboard for that as well which is also coming from the uh Carana dashboard uh repository with a bit little bit of uh National Library magic around it uh same variables as with the previous dashboard and it shows logs and yesterday I was um present during the Keynote and they were presenting the log U met the log exploration feature I was thinking this dashboard can go into the trash because that uh the metric Explorer or the log Explorer is actually uh doing almost the same as this and then better so um that's a nice feature I think uh will be the first thing that I will discuss tomorrow when I go back to the National Library and that's actually the it it sounds um maybe not like that much but it helps our teams to be able to debug issues relatively quick so if uh a product owner or somebody else comes to the team and say we have a problem they can start using this these two dashboards to really drill down into the issues relatively quick without uh well a minimum amount of configuration and um but this is not the end for the national library because this is just uh the tip of the iceberg um what's next well we did not do anything with alerting yet because we wanted to be uh start quickly and enable teams to do their debugging first but uh for the next three months we we'll be working on alerting to help teams uh be more proactive in the issues because you don't want a product owner uh to come to your table say hey we have this issue and you and that we don't know about it so that's one thing we don't we didn't do anything with tracing yet uh so we're going to adopt the full lgtm stack uh and we're going to use pharoh for front end observability because most of the things that we did until now was for backend applications um and uh we figured that grafana phoh will really help us uh in completing that uh observability stack and um the last but not least some highlights um I said teams enrolled within a day of effort but actually it's two lines of code so the effort is maybe a second or a minute uh I put a day because we have to wait for pool requests every time um but uh still relatively quick uh well the observability Via Prometheus is something that the teams really like they uh they uh you see eyes opening when we uh first show them the dashboards uh the look analytics is really cool and um one of the things that was that I did not talk about was uh single sign on it's uh even if you deploy it yourself it's really simple I think uh if you can ride gaml you can do it within an hour uh so uh yeah we um I really enjoyed implementing this at the National Library uh the teams that are using grafana until now uh are also very enthusiastic and if you want to do something with grafana uh on bare metal machines you can always contact me because I'm also in contact with gravana about uh an um uh Distributing our uh collection to be used open source

