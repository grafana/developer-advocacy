# Grafana Agent Community call 2024-01-17

Highlights - Compatible Components Reference 0:17 - Metamonitoring the Agent 4:30 Join our next Agent community call: ...

Published on 2024-01-20T01:40:02Z

URL: https://www.youtube.com/watch?v=TTcdzeqwIms

Transcript: welcome to the January edition of the grafana agent Community call uh today we're going to talk about a couple topics the first one we've got is compatible component links in our reference documentation and the second one is some information on meta monitoring with the grafana agent so with that I'm going to kick it over to P who's going to talk about the compatible component links thanks p uh thank you so uh hi I'm P software engineer on graphon Squad and I wanted to show you one thing that we have added recently to our reference documentation which is uh compatible components uh so if you are browsing flow mode uh documentation and you might be using our uh reference docs a lot uh so for example if I go to uh component reference um let's say I'm trying to discover uh Targets in kubernetes so I would use Discovery kubernetes component um yes you might you might find this documentation to be like the most exhaustive uh most useful for finding all the configuration properties that you need uh however it becomes sometimes hard to find what uh what components can connect with each other so in order to facilitate that we added at the bottom of um every reference uh page this section called compatible components and in this case we can see that uh Discovery Ceres has exports that can be consumed by the following components so all the components that consume targets if I click on this link gets me to this list uh that shows uh components that uh consume uh that can consume targets so if I um then let's say uh select Prometheus um I can see that Prometheus scrape can consume Target what else Discovery process Discovery label um and in this way I can kind of uh start building my pipeline uh and discover what can talk to what so let's click see a little bit more um a few more examples of this so if I click on prome scrape again gets me to the reference page with all the uh configuration details and then at the bottom again we have the section uh that can redirect you to other uh components that can uh be connected uh so for example permit use metrix receiver um so let's see there are uh other components that export prit use metric receiver uh for instance promit use remote right that might be another component you might want to uh consider so uh and then again it also um you can see the reference page and then compatible components um so this way uh this way uh we hope to kind of address the problem and make it a little bit easier to build uh pipelines um by adding those links and there's also like this dedicated page over here called compatible components um this is AOG generated uh we are just getting started with uh generating maybe more use things in docs and you can also see that this is a preview of new structure um so in general um yeah watch this space there will be new things coming and uh please let us know if you have any feedback uh having said that uh are there any questions all right uh if there are no questions regarding this topic I'll hand over back to Eric thank you okay great yeah thanks VI and uh now we're going to jump a little into some meta monitoring information and if you have any questions feel free to to throw them in the chat or raise hand and I'll try to catch them on my other monitor okay let's get this set up okay uh So Meta monitoring for the grafana agent so the concept of of meta monitoring is kind of I think of it like this is like who who watches the Watchmen so we've got our monitoring systems and the question is well how do we know if our monitoring systems are healthy I I suppose you could then take that and say well then who watches those who watches those and keep going but uh you know you want to do like a reasonable depth there so the question in this case is for our grafana agents how do we know that the graffan agent itself is healthy and everything is working um how do we answer that question so here's I guess for the the context uh for this presentation is our definition Meta Meta monitoring which is the process of being aware of our own monitoring capabilities here's a little diagram to describe the problem that we're talking about here so one common solution is we have our apps and our infrastructure um they're getting data pulled into the grafana agent or pushing data and then that data is going into a Telemetry database um the other path we have here though it's common that maybe you have a secondary meta monitoring Telemetry database that you push uh the data for the grafana agent into uh you can push it into the into the main Telemetry database as well uh if that you know database were to go down you may not have information um or if it's issues uh so you may want to do a secondary so I just want to lay that out so let's get start so we're going to take a look at an example of how to do this today um we'll leverage some configs publicly maintained in the grafana agent modules repository uh we're going to Target the Prometheus Loki and Tempo databases in graffan cloud and I also like to say that this is a great way to make sure that your graphon agent is up and running with connectivity so that means like let's make sure that our graphon agent can talk to our Telemetry databases before we introduce additional variables such as exporters and other things it's nice to know that hey I can get data from the agent to the Telemetry database uh before adding those in so that you know where if there is a problem you then know uh where in the pipeline that that problem may exist some Concepts that this will kind of rely on as we go through uh components that's like the key building block in low configurations uh config blocks are I guess also in your configuration they're similar to components but a little bit different um in our case we'll be leveraging the logging and the tracing config blocks at the end we're going to look at what this would look like with modules we're going to start without uh because I think that's the clearer example um but then I'll just briefly show uh what it would look like with modules uh we'll make use of the river standard library with the environment variable functions um to set our variables there's other ways to do this but that's the one we'll do for this presentation and then we'll be running the grafana agent uh with the CLI on the command line so what are the steps to doing this uh so step one we're going to we would install the graphon agent uh on whatever platform and the instructions here I've throughout the presentation in case you know you're watching this online I've put the full link written out so that that you can get to it um once you've installed the agent we'll follow the instructions in this demo here to uh run the agent and for this one you can kind of take this as your starting configuration file and then make it your own going forward if you just you know copy paste it out of uh that repository and here's the command that we're using to run it so I'm resetting the storage path to a path that I have right privileges on my system and I'm giving the path to that uh River configuration file what does that look like so here it is running with my specific uh stuff uh punched in running that River file exactly as is with no modifications here I've created a little dashboard and we can see we've got the metrics demonstrated here with some you know very simple queries just to kind of demo that the different types of data are getting where they need to go in in graffic Cloud uh over here we've got the traces uh and then I've got a couple uh little log dashboards here with uh one showing just all the logs and then one showing if I had errors uh thankfully you know in this case no errors so that's a good sign once we have the Grana agent uh we do have the debug UI available as well to click around and see things it's going to be hosted at on Local Host wherever the agent is running and the default Port is 1 2 3 45 if you use the command line args to update the port that the agent is running on then it will be on that same port so you can take that uh River file mentioned previously and make it your own and go from there uh but if you do want to use a pre-built module to do the same exact thing we do have one available so here's uh a link to it and then on the right hand side this is the the config file you will have to create yourself to reference that module that that pre-exists and in our case uh this is where we make use of a couple of those config blocks um with modules today config blocks cannot be defined within a module they have to be at your top level config which is why this module exports um the trace input and the log receiver for use uh for forwarding logs and traces too uh so yeah and then you would you would repeat the same the previous steps for running the agent that you've installed uh but now you're pointed at uh your newly created config file that looks uh something like the right hand side and the instructions to doing this are are also here uh with this link uh closing thoughts so yeah graphon you know the the monitoring for the graphon agent allows us to track component Health logs resource usage and there's there's much more it's uh you know there's quite a bit of telemetry data that the agent comes with out of the box so you can make use of that um and yeah I say here you know while we want it to just work uh sometimes you know programs don't just work and having this data is helpful um for example if you're running out of you know memory or CPU uh this is a way to track that data from the agent like you would with any other application so you know that could be a reason why your uh monitoring is not working as you anticipate and then it's something that that you can address so uh that's it any uh questions

