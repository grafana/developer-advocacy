# (Spanish) Entendiendo los Sintéticos (Café con Grafana #008)

En este episodio de Café con Grafana les traemos a Marcelo Magallón, experto en monitoreo sintético, quien viene precisamente ...

Published on 2024-01-12T04:15:32Z

URL: https://www.youtube.com/watch?v=fXNSqrUtiJo

Transcript: [Música] Hola hola Bienvenidos a todos y todas Feliz año nuevo un poco [ __ ] estamos Este 2024 empezando y estrenando nuestro primer cafecito del año Ay demasiado café pero hay que empezar bien el año Hola a todos y bienvenidos a café con grafana Empezando este 2024 eh tenemos hoy con nosotros pues como usualmente o a veces andamos aquí como decimos en México cambalache qué Qué significa qué significa eso cambaleando Marcelo tú dominas yo entendería que jugando o intercambiando ándale más o menos eso aprendiendo chilango one one o introducción ch ya hemos comenzado muy mal y como decía intercambiando a veces aquí y ahí hoy tenemos con nosotros también a nuestra amiga Nicole Nicole Cómo estás Cómo empieza el año Hola Cómo están ustedes estoy aquí reportando desde los Países Bajos y como mencionaba hace rato Un poquito oxidada con el español así que tenemos que ponerla hoy a prueba Sí para que estire todos esos músculos lingüísticos y también hoy tenemos como invitado especial a nuestro amigo Marcelo Magallón Marcelo bienvenido Cómo estás Muy bien y ustedes Muchas gracias muy alegre de estar aquí en el programa es un gusto tenerte aquí y muy emocionados por todo lo que pues vamos a platicar hoy eh Antes que nada ya aclaró que reporta desde los Países Bajos acá tienen a su servidor reportando en este momento desde Ciudad de México ya ven otros episodios que me vieron reportando también de lugares variados y peculiares Marcelo dónde estás hoy en día hoy estoy en San José Costa Rica creo queo gaviotas o es posible porque en el frente mi casa hay un jardín y hay pajaritos hermoso día Parece ser con este cafecito y ahora vamos a cambiar un poquito la dinámica no quiero hacerlos perder tanto tiempo en nuestros anuncios y demás vamos a ir a los anuncios va a haber aquí algunos detalles al rato pero pues Generalmente estamos emocionados vamos ya hablar de esto Oigan quiero esta cosa de los sintéticos Qué pasa pero antes de entrar en ese detalle eh Marcelo cuéntanos de ti cuéntale a la audiencia quién eres Qué haces Por qué vienes a hablarnos de sintéticos qué Qué te pasa Qué Qué onda contigo muchas gracias e yo soy Marcelo Magallón e Soy ingeniero aquí en graf laps comencé a trabajar acá hace 4 años y unos pocos días Este antes de eso trabajé mucho tiempo en el área de redes de de servidores pero como programador no Como operador entonces trabajando en la parte de desarrolló sistemas para equipos de red este y antes de eso ya era programador en otras cosas acá lo que me trajo grafana o la razón por la que estoy aquí en grafana era básicamente un interés en en la parte de observabilidad que ha sido que fue siempre una constante en el trabajo y en algún momento dije Bueno trabajemos en esto de lleno me interesa es divertido es interesante entonces trabajemos en est de lleno y básicamente así fue como llegué a a grafana la Apps yo eh curiosamente trabajo más que todo en el lado de de Linux que no es algo muy fuerte en el trabajo de grafana pero digamos es lo que utilizamos este en el día día para la operación de los servicios de los productos entonces también por ahí había alguna afinidad se grafana Yo comencé a usar grafana mucho antes de comenzar a trabajar acá eh te diría que hace unos que casi que desde la versión un mentiría si dio que era la versión uno pero por la versión dos o tres Oh Wow O sea sí Ahora sí que veterano en serio Todos estos temas Oye y también hoy en día cuál es tu rol En grafana qué andas haciendo como Bueno desde que Yo comencé acá en grafana comencé a trabajar en es producto en synthetic moning este el nombre del producto es monitoring este y en español en español se refiere a monitoreo sintético o sea podemos conversar luego qué quiere decir eso pero el producto es esencialmente ese eh Cuando Yo comencé Había otro producto similar que se llamaba World ping ping la cosa con la que enviamos para chequear si la conexión de red funciona o no funciona con un destino específico Oigan si a alguien se le ocurre tiene traducción yo creería que no Marcelo sacó pantalla azul así decir todo si alguien viendo se le ocurre déjenlo ahí mándenos un comentario me salió duda en el momento que lo decías Perdón Marcelo no no importa Este y warping era un producto muy querido y muy bien recibido pero ya tenía su sus añitos este Y entonces cuando Yo comencé a en grafana me dieron la oportunidad de escribir una versión dos de ese producto y la intención nuestra intencionalmente era probar En aquel momento Yo comencé en el 2020 este probar En aquel momento si era posible desarrollar una aplicación utilizando grafana como entorno de de de interacción para el usuario y entonces así fue como nació sintético tring eh recibimos colaboramos mucho con con mucha gente aquí dentro de grafana este para que el producto funcionara y por allá de abril mayo de 2020 eh lo anunciamos este oficialmente y recibió buena acogida y tenemos una cantidad importante de usuarios grandes y pequeños y Estamos contentos estamos continuamos desarrollando el el producto qué es lo que yo hago yo estoy a cargo de del desarrollo de ese producto Oye y yo sé O tengo entendido ver si no estoy haciendo spoilers qué está evolucionando no Y tú también estás haciendo algunos cambios sí estamos platicando ciertas infiltraciones aquí te refieres a que inicialmente nosotros eh el agente nuestro el agente de s monitoring que es que es Open source que es de código abierto e nosotros lo basamos en un producto existente un software existente de de promos que se llama Black box exporter el exportador de caja Negra este que básicamente provee la funcionalidad de ejecutar lo que nosotros en s mon llamamos el el check la Prado este y cuando k6 pass se unió con grafal Apps cuando cuando cuando nos unimos como compañías este inmediatamente desde el equipo de sintético monitor dijimos Bueno eso es es eso calza muy bien con lo que nosotros hacemos no era el caso de uso principal de de k6 de k6 eh pero inmediatamente reconocimos que había eh un traslape de funcionalidad y que había una oportunidad para desarrollar el el el producto en nuevas direcciones Y entonces hace aproximadamente un año comenzamos a trabajar en incorporar eh el motor la herramienta de k6 de dentro de stic entonces De hecho si hoy van a grafana Cloud este al producto hospedado en la nube verán que una de los tipos de pruebas que se pueden crear en syntic moning dice multi http este multi http este Eso se refiere a que nuestra prueba original de http puede verificar exactamente un URL y se pueden hacer validaciones y otro tipo de cosas pero es exactamente uno entonces eh la dirección que tomamos para comenzar a incorporar eh k6 dentro del producto era ofrecer la oportunidad de múltiples eh urls en un solo check este Encadenados con validaciones que se puede reutilizar datos de de un de de de un servidor para realizar la petición siguiente ese tipo de cosas que es que es funcionalidad que nos han pedido los los usuarios prácticamente desde que comenzamos y e para eso nos apoyamos en en casis entonces hemos tenido una interacción muy agradable muy provechosa con con todo el equipo de casis tengo que darle las gracias ha sido realmente una experiencia muy agradable Y entonces en ese sentido como compañía Tuvimos una reorganización interna donde syntetic monitoring que se encontraba dentro de lo que internamente llamamos probabilidad de infraestructura eh paso ahora a ser parte de la sección de cas Marcelo Cómo definirías el monitoreo sintético Qué es eso qué es eso muy buena pregunta e a alto nivel la intención la razón por la que se llama sintético es porque lo que pretendemos lo que lo que tratamos de hacer es simular las interacciones del usuario con un servicio un servicio web o un servicio de otro tipo pero Entonces tal vez el caso más simple lo que yo dije antes tenemos una prueba que es de tipo http entonces lo que esa prueba hace Es simplemente toma un URL con parámetros con cierta configuración y visita el sitio indicado múltiples veces este múltiples veces por mes es config durable en nuestro producto eso se traduce rápidamente en cientos de miles de visitas por mes porque la la el chequeo se hace como máximo una vez cada cada dos minutos se puede hacer con más frecuencia pero como máximo una vez cada 2s minutos Entonces el objetivo de eso es reportarle a nuestro usuario a la persona que está utilizando sintic monitoring Cuál es la experiencia de otros usuarios respecto al servicio web que le interesa Entonces el por ejemplo eh yo tengo el sitio web de mi empresa grafana.com este Quiero saber si otros usuarios en el mundo están teniendo una buena experiencia con ese servicio si lo pueden alcanzar si no están viendo errores este si los tiempos de respuesta son razonables si lo que el servicio provee como respuesta es lo esperado ese tipo de Cuestión entonces Esa es la parte de sintético en el sentido de que no hay un usuario es un programa de computadora y monitoreo porque se hace de manera continua es es diferente el caso de uso de el caso de uso actual de k6 en el cual en k6 lo que se pretende es con la parte de prueba de carga lo que se pretende es decir Quiero saber cómo responde este servidor ante un incremento de carga entonces seig Ur k6 para que envíe muchas peticiones de forma simultánea syntetic monitoring no hace eso syntetic monitoring Envía una petición pero le envía de forma repetida ahí me me me brinca mucho tanto Nicole como yo venimos del mundo del testing Qué diferencia hay de una prueba automatizada que tienes estas verificaciones y validaciones que mencionas a un sintético que también está haciendo algunas de estas validaciones y verificaciones No Qué qué dirías qué es la diferencia porque a veces hasta yo me atoro tratando de explicarlo Bueno es es Es natural porque hay Hay muchísimo traslape entre ent entre los conceptos eh yo como lo mío es programación Yo lo pienso en términos de en qué momento quiero hacer la prueba este si están familiarizados con con con ese lado del mundo en programación hacemos pruebas muy pequeñas este contra un objeto individual a lo que llamamos pruebas de unidad entonces esa prueba está orientada simplemente decir Quiero saber si esta función hace lo que yo quiero que haga lo siguiente que hacemos ahí pueden haber bemoles pero lo siguiente que hacemos son pruebas de integración Quiero saber si esta función en el conjunto de todo el todo lo que estoy eh Armando este continúa haciendo lo que hace si el servicio Como un todo si la si la integralidad del servicio está haciendo lo que yo y creo que haga luego más arriba de eso tenemos este pruebas de aceptación pruebas de rendimiento pruebas de validaciones ese tipo de cosas y conforme vamos escalando esas pruebas van tomando cada vez más tiempo y más recursos una prueba de unidad es una prueba que tiene que ejecutarse muy rápido usualmente en menos de un segundo idealmente menos que eso eh unas pruebas de integración perfectamente pueden tomar varios minutos este 30 minutos una hora dependiendo de que exactamente se est buscando y las pruebas de aceptación este las que ya validan que toda la funcionalidad del producto es la que esperamos este pueden tomarse mucho tiempo en un trabajo previo eh teníamos lo que efectivamente eran pruebas de aceptación que ocurrían durante varios días Entonces eso validaba eh que la funcionalidad del producto era la correcta y que la operación del producto era la correcta bajo condiciones de carga monitoreo sintético eh se ubican más hacia el inicio de esa descripción hacia la prueba pequeña de de que las cosas individuales están haciendo lo que se espera pero no necesariamente se ubica en ese extremo este por ejemplo eh un caso de uso normal típico es Yo quiero saber que el servicio que estoy monitoreando está operando entonces eso no es una prueba de integración eso no es una prueba de unidad simple ente una prueba se observa que el servicio esté operando de forma continua como se espera Entonces no estoy tratando de validar toda la funcionalidad del servicio Porque esa prueba duraría mucho tiempo en ejecutarse estoy simplemente validando que el servicio esté arriba Entonces si damos Un paso atrás y pensamos en el resto de productos que ofrece grafana laaps eh monitoro sintético eh hace pruebas desde afuera o sea nuestros agentes de synthetic monitoring corren fuera de la infraestructura del usuario no corren dentro de la infraestructura no corren en la red interna del usuario Aunque es posible sino que corren fuera nosotros tenemos eh en este producto tenemos 22 ubicaciones alrededor del mundo eh Londres París Nueva York San Francisco Tokyo Sydney eh desde las cuales se envían las peticiones entonces eh el objetivo de eso es decir puede ser que el usuario en Nueva York o cerca de Nueva York esté experimentando buenos tiempos de respuesta el servicio está arriba no hay nada anormal pero el usuario que está en Sydney eh Ya sea porque la red está entre los dos puntos entre Sydney y el y el destino está caída o es lenta o está teniendo problemas este no está experimentando la misma clase de servicio o alternativamente puede ser que simplemente no tenga el el el quien provee el servicio no tenga una presencia suficientemente cerca de Sydney Entonces desde el punto de vista del usuario de Nueva York el tiempo de respuesta son 50 milisegundos y desde el punto de vista del usuario de Sydney son 500 Entonces ya ahí entramos en aspectos de psicología respecto a si un usuario cree que algo es lento o no entonces ya ahí es todo un tema de optimización y y es la clase de de datos que synthetic monitoring busca proveer entonces una vez que ya has determinado que sí que el servicio es lento eh Te toca determinar si es lento por la red si es lento por la base de datos si es lento por el programa que está proveyendo el servicio o si es lento por alguna otra razón Entonces ahí es donde integramos con todos los otros productos de grafana este por ejemplo eh el agente de grafana este que está observando ese programa ese servidor internamente Y dice Bueno es que yo estoy recibiendo tantas peticiones por segundo se están respondiendo el 95 un tiempo inferior a 100 milisegundos Pero hay un 5% eh que no es cierto por ejemplo es como si fuera lo contrario de grafana Faro porque faro es el nivel de de Front end el monitoreo del frontend y y synthetic monitoring es en en el nivel de de la infraestructura con faro tenemos un traslape también porque faro está monitoreando Cuál es la experiencia del usuario real este faro está integrado en la página web por ejemplo que se está sirviendo Y entonces están tomando métricas desde el navegador del usuario qué es lo que el usuario está viendo Cuáles son los tiempos reales que el usuario está observando cuando lo que pasa es que con Faro dependemos de que exista un usuario usando el servicio en ese momento Entonces con synthetic monitoring proveemos el complemento de eh No necesariamente tiene que ha un usuario con una sesión abierta sino que simplemente estamos asegurándonos que el servicio esté disponible para que cuando llegue su usuario este realmente el servicio esté ahí presente creo que tengo otra pregunta a Dale dale dale has mencionado Marcelo que que syntic monitoring es un proyecto Open source pero es posible usarlo sin grafana Cloud eh Qué buena pregunta es una pregunta en la que los usuarios caen rápidamente e la respuesta estrictamente hablando es que no eh en por una razón sencilla eh el el el ag gente de syntic moning que se puede encontrar en en en github en la organización de grafana eh es Open source nuestra primera intención para que esto sea Open source es que es un agente que se puede correr en la infraestructura del usuario para monitorear cosas que por dos razones una eh Para monitorar cosas que no están expuestas a internet cosas que solamente están disponibles dentro de una red privada y la segunda puede ser que el usuario tenga interés en ejecutar el agente desde una ubicación que nos nosotros no cubrimos por ejemplo tenemos e agentes corriendo en Sao Paulo Brasil pero no tenemos de momento agentes corriendo por ejemplo en Ciudad de México o en Santiago de Chile por nombrar un par de ubicaciones en Latinoamérica Este Entonces si fuese que hay un usuario que tiene interés en medir eh las métricas que nosotros proveemos desde esas ubicaciones puede tomar el agente instalarlo en su red Y ejecutarlo desde ese lugar pero volviendo a la pregunta de de si se puede ejecutar sin grafana Cloud la interacción del usuario con el producto ocurre a través de grafana y ocurre específicamente a través de grafana Cloud la razón para eso es porque hay un componente de syntic monitoring que no es Open source que es la Api detic monitoring el servicio del cual los agentes hablan del cual obtien eh el trabajo que deben hacer y la única razón por la cual este servicio no es Open Sor es porque tiene una alta integración con nuestra propia infraestructura o sea depende de la forma en la que nuestra infraestructura opera entonces para nosotros no Sería posible proveer soporte a los usuarios en una instalación de esa Api en su red si no tiene acceso a nuestra infraestructura a las cosas que son internas para la operación graf Cloud eh nos han pedido ocasionalmente que si ese componente se puede hacer Open source digamos que la respuesta es que sí pero no en el sentido que sí no no hay realmente nada ni mágico ni secreto respecto a lo que ese componente ha pero no porque eh En realidad no tenemos un caso de uso ni claro ni ni bien definido respecto a qué es lo que ese componente tendría que hacer o no hacer fuera de la infraestructura de grafana Cloud O sea que esos detalles son bastante específicos me haces pensar mucho No sé eh Hay autos que son intercambiables sus piezas es fácil pero pues tienes no sé un tesla que sí le podrás poner una batería de otra marca y probablemente funcione Pero hay integraciones exactas que a lo mejor algo no va a cuadrar y estar dando mantenimiento esas integraciones con baterías ajenas puede ser Problem puede ser complicado O sí Entonces ese sí se entiende uno puede hacer sus propias y también el monitoreo sintético hecho en casa también es todo un tema sí eh se puede es interesante pero entiendo eh que esta integración específica de nuestro agente sintético sí es más e pues para que juegue bien con el resto de las cosas en grafana y ahorita algo algo que mencionabas que se me hizo enlacé muchos ideas y cosas que uh hice una palabra acá y luego la otra aquí y como que de repente se me conectó cuando dijiste del servicio de Ping Sí me parece que esa es la diferencia crucial de una automatización de pruebas en general a un sintético el sintético nada más su mayor razón de existir es estás vivo estás vivo sí estás vivo qué tan vivo no también ahí a la vez está preguntando ese tipo de cosas porque y muchos dirán no Por qué pues faro también está reportando ese tipo de cosas pero como dices requieres del usuario sí Y a mí me gusta mucho hacer hincapié en cuando cualquiera de nosotros experimentamos un problema en una plataforma que usamos qué hacemos sacudimos el puño cerramos la ventana y nos vamos no exactamente y y y la organización que tiene ese producto pues tal vez no se entera o hasta que ya es algo grave en cambio Si tienes un sintético que está chequeando está chequeando está chequeando tal vez el usuario ya cerró la ventana se enojó se fue o ya está posteando en Twitter o x como dicen ahora y Pero tú ya sabes tú ya estás tomando cartas en el asunto ya estás reaccionando o mínimo tienes una métrica al respecto eh doy un ejemplo de mi proveedor de internet aquí en Ciudad de México sí que tienen algo así y se me cayó el internet claro no ahí sí en esos casos no tardas ni dos segundos en correr a llamar Oigan traigo caído el internet por favor en el instante que les marqué y de verdad no me tardé más de 5 minutos tenía una junta una llamada o algo que me urgía y lo primero que suena Oye sabemos que estás llamando De esta zona y sabemos que hay un problema de red en esa zona tranquilo lo estamos arreglando en un momento va a volver FES como de ah Oh Okay Bueno ahora ya sé que tengo que correr a starbuck y ya lo están atendiendo y ver de dónde hago mi junta pero tiene esas ventajas el monitoreo sintético no puedes saber cuál es el estado de tus principales componentes y ahí me venía una pregunta hay ciertas automatizaciones de prueba en especial k6 no que si lo dejo andando con un periodo que se repita no sé como dices cada do minutos minutos como nuestra automatización a mí me gusta correr eso en otros ambientes porque sintéticos pues lo más indicado es produc ambientes productivos no Cuál es la diferencia si lo quiero correr en ambientes preuc y ver sobre todo para este avance de software en mi ciclo continuo hacia producción No qué opinas de eso ese me parece un escenario realmente muy interesante y es algo en lo que estamos trabajando eh precisamente por la integración que estamos realizando con k6 que hablaba antes eh una de las cosas en las que estamos trabajando futuro y esto ha sido mencionado en varios lugares en varios lugares públicos es eh Como decía antes en este momento lo que hacemos con k6 es permitirle al usuario especificar una serie de pasos que la prueba va de tomar y integrarlos la integración se realiza con k6 eh hay casos de uso que no se pueden expresar de esa forma que en las cual el usuario realmente necesito decir quiero que haga esto y si la respuesta es esta entonces tome Este paso y si la respuesta es esta otra Tom este otro paso diferente y ese tipo de cosas eso ya va más en dirección de pruebas muy específicas en torno a un producto particular que es que es un poco hacia donde estás apuntando entonces Ahí es donde nosotros queremos ofrecerle al usuario la posibilidad de que nos den un Script no una una serie de pasos descritos a alto nivel sino un Script de k6 este y Entonces nosotros lo vamos a ejecutar de manera periódica Entonces ahí es donde entra lo que tú acabas de mencionar básicamente en ese caso podrían ejecutar el agente de syntic moning en una red interna y comenzar a ejecutar esa prueba de manera repetida este sin detenerse y entonces eso lo que provee es una prueba de monitoreo continuo por ejemplo un ambiente donde los programadores están haciendo cambios a un producto y apenas ese cambio llega al sistema de control de versiones que corresponda y se publique inmediatamente a un a un servicio interno a un a un a un área de de de previsto por llamarle de alguna forma este entonces intic monitor puede decir Eh Esto que tiene que funcionar que según la prueba tiene que funcionar que según el Script tiene que funcionar dejó de funcionar hay un cambio que entró en el código de del producto que rompió algo entonces eso sería monitoreo continuo puede ser también por ejemplo que no sea un cambio de de código puede ser que sea un cambio de la base de datos este alguien Estaba tratando de optimizar algo en la base de datos este modificó el esquema de la base de datos este hizo todas las pruebas necesarias localmente y en el momento que eh publicó ese cambio al ambiente de pruebas al ambiente compartido con con toda la empresa de pronto algo deja de funcionar eso nos ha pasado absolutamente todos los programadores en algún momento este Y eso no seguirá pasando absolutamente todos los programadores por el resto de los días Entonces eso es una realidad con la que hay que lidiar Y entonces ahí es donde entran estos sistemas de monitoreo continuo que dicen Si el el producto se se comporta como se espera que se comporte Y entonces ahí es donde entra el el la persona que hace pruebas o el programador en algunas empresas es la misma en algunas empresas no este donde dice este programa escrito en javascript con la funcionalidad de k6 valida que lo que debe estar ocurriendo está ocurriendo es un poco me hace pensar mucho en estos monitores de de salud que en cierto modo es un sintético y que como dices tenemos este no sé tu pulso habitualmente está 70 Oh está en 120 que está pas Ah es que se sub la caminadora Ok está bien o no no está sentado y es un problema le cambiaron la base de datos adentro y ahora ya está con pulso mayor Me parece muy interesante porque así detectas no Sí claro Hay gente que naturalmente su pulso descanso es 90 y dices okay lo normal sabes que no hay una desviación grande eso Que dices es exactamente el el meollo del asunto Qué es normal porque desde el punto de vista de una persona que no sabe el producto Bueno yo quiero que el producto responda en 3 milisegundos Y puede que eso sea realista como Puede que no lo sea entonces para otro producto puede ser que es esos 3 mil segundos no sean tres sino que sean 30 entonces eh Tienes que definir Qué es normal Cuál es el comportamiento normal de algo y monitorear con respecto a eso es muy importante también establecer baseline una de base para cada aplicación o componente y ahí es donde tenemos este otros productos dentro deana Cloud que ayudan con eso Por ejemplo tenemos la parte de Machine learning aprendizaje automatizado aprendizaje por máquina en laal básicamente producto que tenemos hace Exactamente eso dice estos son los rangos dentro de los cuales esta métrica se comporta normalmente y puede crear enviar alertas en el momento que eso se sale de del comportamiento normal sin que el usuario tenga que a priori decir Eh mi expectativa para lo que esto va a haer es esta sino que simplemente el sistema aprende sobre la marcha y se adapta respecto a Qué es normal que no y el Machine learning También incluye un pronóstico del futuro de los rangos en el futuro exactamente Entonces por ejemplo Machine learning una aplicación interesante en combinación con stic monitoring puede ser nosotros simplemente recolectamos la información de cuál es el el comportamiento en este momento de un servicio y con el producto Machine learning entonces podemos determinar eso que estamos viendo eso no es normal puedes demostrarnos Cómo usar Cómo Cómo comenzar con el monitoreo sintético eh si puedo compartir la pantalla un momento Claro que sí muchas gracias este Oh te voy a pedir podemos hacer un pequeño zoom puedes hacerte a ver si no se bate mucho porque si está pequeño para que excelente Gracias hay quienes nos ven en dispositivo móvil y luego Sí eem esta es la pantalla si Tú comienzas con grafana Cloud Esta es la pantalla en la que la primera pantalla que el usuario ve este No necesariamente eh va al Home deana sino que va a la parte donde se agregar una nueva conexión Entonces si revisan esa lista van a ver que una de las opciones es syntic este y cuando hacen eso eh básicamente se le da alguna información al usuario puedo quitar esto este y lo único que hay que hacer nosotros no habilitamos el producto por omisión sino que permitimos que el usuario decida si lo quiere o no lo quiere habilitar habilitar el producto no tiene ninguna consecuencia Entonces al hacer eso eh básicamente eh cambia un poco la vista y lo siguiente que uso puede hacer es crear una prueba crear un check este yo sueño con el día en que tengamos una interfaz significada en otros idiomas en grafana pero todavía no hos llegado ahí este entonces lo que les comentaba antes eh tenemos múltiples tipos de pruebas http ping tcp dns TR rout Y esto es lo que les decía antes de lo que denominamos multip entonces Cuál es la diferencia entre el check http y Ping eh el de Pink que es el más sencillo de todos eh él simplemente valida la conectividad de un un destino entonces voy a usar grafana.com Simplemente porque es lo más fácil en este momento Y entonces lo que el usuario tiene que especificar como está haciendo una prueba de Pin para atender a la pregunta lo que tiene que especificar es el nombre del del de internet del servicio que se quiere validar no es el URL simplemente el nombre de de la máquina entonces lo siguiente que el usuario tiene que hacer es seleccionar algún lugar en el mundo desde el cual quiere ejecutar esa prueba entonces Esas son todas las ubicaciones que tenemos disponibles voy a seleccionar solamente una al azar Y entonces hay otra serie de Par puedes seleccionar varias Sí claro V a seleccionar todas este entonces eh hacer eso tiene sentido eh digamos algo en Estados Unidos algo en Europa y algo en Asia Eh entonces hay otra serie de opciones que se pueden configurar Pero esas son las únicas tres cosas que se tienen que configurar entonces eh yo grabo eso Entonces ahora mi vista de la lista de checks es diferente Ahora simplemente me dice existe este y se está ejecutando cada 60 Segundos desde TR ubicaciones diferentes esto para los que están familiarizados con grafana Cloud Esto va a generar 93 series eh de tiempo diferentes eh Y si espero un momentito voy a ver que comienza a generar datos eh vamos a ver si reduzco esto un poco para la prisa entonces eh básicamente esto lo que está haciendo Es que mandó la petición de ejecutar esta prueba a diferentes agentes corriendo en todo el mundo y eventualmente este cuando esos agentes tomen el trabajo y lo comiencen a ejecutar eh vamos a comenzar a ver datos Entonces si esperamos un momento para en en lo que esto va cargando eh Por ejemplo este de Ping la utilidad mayor que yo considero es literal eso no como cuando usábamos un pin Oye el servidor está prendido conectado a la red está el servicio arriba creo que es lo más trascendente de un pin no exactamente entonces eh y toda la red entre uno y ese servicio no o las ubicaciones que tú definiste Sí exactamente entonces Marcelo Sí este este pin utiliza casis o todavía no ese pin no este ninguna de estas cosas que estoy haciendo en este momento utiliza casis vale eh estoy haciendo lo mismo nuevamente para atender tu pregunta Nicole estoy haciendo básicamente lo mismo pero con http la diferencia con lo que hice antes es que ahora Esto va a cargar el URL va a cargar la página va a descargar los datos de esta URL este desde las mismas ubicaciones entonces voy a configurar eso también este Y entonces ahora ven que tengo dos cosas este dos cosas que son diferentes una es pin otra es http y aquí pueden ver que ya tengo eh algunos datos eh fluyendo hacia grafana como por defecto grafana opta por eh este tiempo de 6 horas Si lo reduzco simplemente para efecto de ver algo un poco más interesante Esto está corriendo un una vez cada minuto entonces por eso es que solamente veo un punto acá Este y este panel en particular lo que me dice es cuál es el la cantidad de errores que estoy observando Entonces esto está está en cero lo otro que veo acá es que tengo datos desde desde Virginia del Norte eh tengo datos desde Frankfurt y tengo datos desde Tokio entonces para esas ubicaciones para cada una de ellas eh Me indica individualmente Cuál es el la tasa de errores que existen y yo puedo por acá Este ver por ejemplo eh Cuáles servicios reportan eh un ping más exacto y cuál es es más rápido entonces eh ven que todos estos datos eh se van agregando y se van actualizando en tiempo real entonces acá probemos otro tipo de de información este cuánto tiempo se dura en la resolución de nombres cuánto tiempo se dura en enviar el pin cuánto tiempo se dura en que las cosas se configuren etcétera entonces acá como les digo lo que vamos haciendo es recolectando datos de del servicio Y si cambiamos a a http que fue lo que hice eh ven que ya se está ejecutando también por lo menos aquí hay datos de Tokio entonces nuevamente eh conforme va pasando el tiempo se va eh llenando el los paneles con información pero ahí tenemos otras métricas y ahí tenemos otras métricas entonces basado en estas cosas es que los usuarios pueden ir creando diferentes tipos de alertas o sea porque por ejemplo eh lo que esto nos está diciendo es que con la información que está disponible en este momento eh la latencia el tiempo de respuesta eh promedio de este servicio desde los lugares que se está ejecutando eh Son 177 milisegundos entonces toda la petición está durando 177 milisegundos nos da otra información que los certificad de ssl que son los que validan que la conexión está encriptada que estoy hablando realmente en en este caso con grafana o con alguien más etcétera que esto va a expirar Eh me sacó este que esto va a expirar en en en 7 semanas entonces sobre esto se puede montar una alerta y decir Bueno hay que renovar el certificado porque en 7 semanas este eh va a dejar de ser válido y ese tipo de cosas Entonces para eh lo que preguntaba Nicole eh yo puedo crear un check de multip Este es un poco más elaborado de crear como notarán Necesito proveer un nombre y necesito proveer una serie de ubicaciones nuevamente e eh la lista que yo quiera eh Y acá la diferencia es que tengo que comenzar a especificar una serie de urls eh que quiero utilizar para ese efecto entonces eh acá puedo especiar un rl diferentes parámetros y acá ven que puedo decir y ahora Quiero agregar otro entonces eh llevo uno y entonces luego digo Okay ya validé que eh la página web de grafana funciona Ahora puedo validar que eh la hoja de estilos por ejemplo funciona o que los scripts que están en esa página web funcionan Porque estos son pasos individuales el cuando yo digo que voy a validar la página web es solamente ese único documento que se sirve a través de esa dirección si yo quiero extraer de ese documento todos los recursos las imágenes los scripts este las hojas de estilo ese tipo de cosas tengo que hacerlo eh a mano eh Y ahí es donde entra lo que hablabamos antes de que si la intención de alguien es que se valide todo o sea que la página completa sea validada como la experimenta el usuario eso es algo en lo que estamos trabajando hay múltiples formas de resolver ese problema dependiendo dependendo de cuál sea el objetivo uno de ellos puede ser simplemente decir Eh quiero cargar esto utilizando un navegador porque en las pruebas que estamos haciendo en este momento no hay un navegador involucrado es simplemente un programa que envía peticiones http pero para algunos casos de uso es importante que sea un navegador que evalúe los scripts que evalúe las hojas de estilo que evalúe este ahí Ahí me dejas pensando lo que mencionó nicool hace rato no ahí sí sería muy interesante mezclar esta prueba tipo browser con faro exactamente Y ahí sí oh my god explota no Jesucristo español my god explot si ya está usando ya estamos utilizando cas para el multi http quizás podemos extenderlo para usar el módulo de browser exactamente es esa es exactamente la cosa en la que estamos trabajando en este momento eh Oye a m me sale una duda antes de movernos de este d http múltiple algo que aparece en el primer la primera solicitud puedo tradicionalmente correlacionar y usarlo en el siguiente paso Eh sí este cuando yo agrego una solicitud acá eh yo puedo ves que aquí dice eh Cuáles son los eh parámetros de de la solicitud y puedo configurar validaciones este que pueden ser Ah puedo especificar eh Por ejemplo que el texto que se devuelve de la petición contenga eh cosas en particular puedo cuerpo de la petición Entonces el cuerpo de la petición debe contener eh algo específico Este puedo validar que qué s yo el documento que estoy recibiendo es un documento de Jason entonces puedo decir eh una expresión de Jason y aquí ya se cae dentro de cuestiones específicas que requieren conocimiento más específico Este puedo validar que una expresión de Jason para el documento retornado sea o no sea válida y puedo también eh definir variables en la misma forma es decir por ejemplo eh especificando un pad de Jason eh lo que sea eh extraer esa ese valor y entonces utilizar eso en otro paso posterior refiriéndome a dólar y el nombre que le asigne este Perdón este primero de aquí es el nombre del algo así Aquí voy a extraer ese pad de Jason a una variable que voy a llamar doc Y entonces en otra valid posterior puedo simplemente decir mandarlo ya como parámetro doc exacto y y preguntaba porque esto es super importante porque luego tenemos apis o páginas que requieren autenticación antes de poder ser checadas y ese primer paso pues ya te cacha los tokens todo lo que haga falta y ya podemos verificar entonces podemos extraer a partir de expresiones regulares podemos especificar tienen que hacer mat con esto en particular dentro de la página Entonces se puede construir eh de diferentes formas qué Qué información extraer Okay sigamos porque había otra cosa que queríamos ver volviendo al tema de de esto ya que está ocurriendo un momentito eh Entonces ven que la información Se va recolectando nuevamente estoy viendo 6 horas demasiado este la información Se va recolectando entonces voy viendo que hay alguna variabilidad pero no mucha o se vean que esta escala es de cero a pun 3 segundos o sea de 0 a 300 milisegundos entonces hay alguna variabilidad en los tiempos de respuesta pero ya va a depender del usuario definir si esa variabilidad es o no es aceptable lo mismo podemos ver de lado que por ejemplo para Frankfurt este los tiempos de respuesta son bajos pero para toky por alguna razón en este punto hubo eh un incremento en el tiempo de respuesta nótese que esto es una observación Entonces de esa única observación no puedo realmente sacar conclusiones pero una vez que ya tengo una tendencia yo puedo decir ah en este periodo de tiempo eh por alguna razón en Tokio eh los tiempos de respuesta se habían incrementado significativamente Y eso ayuda muy fácil a identificar Cuando algo se porque hay tal cual ves la serie pum hubo algo súbitamente ocurrió Y supongo el siguiente paso natural es configurar alertas no exactamente entonces básicamente dentro del servicio de no dentro del servicio Perdón yo puedo editar el check y acá en la parte de abajo hay una sección de alertas entonces yo puedo decir digamos lo que nosotros proveemos de manera predefinida es eh tres niveles para mí Esto es algo muy importante Entonces yo creo la el sistema automáticamente Crea una alerta en torno a algunas de las métricas que existen acá y entonces eh Esa alerta se va a disparar cuando se superen ciertos niveles esos niveles están definidos para el sistema como un todo entonces yo puedo para cada nivel diferente yo puedo decir eh los checks con una sensibilidad de este nivel van a dispararse si el 95 por de los casos eh No han no son exitosos durante un periodo de tiempo entonces por ejemplo yo digo si el sitio web parece estar abajo no funcionando desde el 95 por de los ubicaciones por un periodo de 5 minutos entonces vale la pena hacer sonar un teléfono hacer sonar una alarma despertar a alguien que vaya a revisar cuál es el problema porque ahorita el que estabas mostrando no que hubo un pequeño pico Pues fue algo Random no lo volvimos a ver y no valdría la pena molestar a nadie por esa cosa vamos pero si ya se queda una hora respondiendo así o no respondiendo ahí sí ya hay que exactamente activar entonces Esas alertas este como te digo están definidas en una forma tal que tratan de determinar si las cosas están dentro de lo normal no dentro no no no son lo que tú dices este estas variaciones aleatorias de de de rendimiento que a veces ocurren Simplemente porque esto Esto es un detalle que hay que tener en cuenta Esto está Rendo a través de internet este mi proveedor de servicio el que yo utilizo para proveer el servicio qué s yo Amazon eh Google quien sea pues puede ser que yo esté operando mi servicio desde un centro de datos en Ohio y estoy monitoreando esto desde Sao Paulo entonces puede ser que la red entre Sao Paulo y Ohio este tenga problemas o haya cambios de rutas o haya modificaciones a la operación de la red Entonces no hasta la tontería alguien está la gente corriendo no sé en tu casa y de repente eh No sé mi mujer se pone a ver Netflix voy a ver una variación subitamente y Exacto pero es explicable y es algo que comoo dices no vale la pena despertar a alguien Oye y nos faltaron ver algunos Perdón Ah sí este básicamente los otros tipos eh las otras clases de cosas que podemos validar son eh entrada de los servicios de dns este Entonces por ejemplo eh podemos nuevamente se especifica eh qué quiero validar qué entrada de dns quiero validar Entonces por ejemplo la entrada de grafana.com eh Y entonces tengo que especificar el valor por defecto es tiene sentido Pero es muy útil puedo especificar por ejemplo eh Qué tipo de entrada específicamente es la que quiero validar dentro del servicio dns Esto es lo que le importa a la mayoría de las personas en el sentido de que es la traducción de nombre de Host a eh dirección IP nombre de a dirección ip6 etcétera hace un hace un año o dos me acuerdo se cayó Facebook única vez en la vida que creo que tuvo que ver con algo de esto que se les desconfiguró el dns y est hubiera sido super Útil para detectarlo de inmediato exactamente entonces dependiendo de qué sea lo que necesitas estar monitoreando por ejemplo hay algunos servicios que dependen de una entrada que se llama txt en la cual eh se coloca cierta clase de metadatos respecto al servicio entonces yo puedo decir okay Lo que quiero validar es la entrada de txt eh la quiero validar con un servidor de nombres particular yo puedo especificar el que yo quiera este Y entonces nuevamente puedo realizar validaciones este qué sé yo esta entrada no puede producir errores esta entrada tiene que responder de esta forma en particular y puedo validar los contenidos por ejemplo eh si en la respuesta existe o no existe una hilera de caracteres específica y Marcelo eh los resultados o los datos que genera synthetic monitoring están en qué forma son logs o métricas o son son ambos este y esta la parte donde grafana yo me encanta lo que estamos haciendo con grafana dices ambos Cuáles ambos ambos logs y m logs y métricas Ah este Entonces por ejemplo Eh Esto está comentado eh Por ejemplo la una de las métricas que se generan se llama sm check info este y entonces yo puedo especificar eh A través de etiquetas Cuál ubicación es la que me importa eh Y para cuál ustedes vieron que yo cuando configuraba los checks les daba un nombre este es una forma de agrupación y les especificaba un un Target lo que se llama un Target Cuál es el servicio que estoy tratando de validar Entonces en un caso en el caso de pinger grafana.com y en el caso de http era URL Entonces esto que yo acabo de escribir eh se refiere a este una de las métricas de ese check entonces hay toda una lista de métricas que se producen Y entonces puedo interactuar con ell de forma que que el producto no pred define yo puedo construir con esas métricas lo que yo quiera este y lo mismo vale para los logs este para Este es un comportamiento que tiene la la promius de momento Está reportado en el que se dieron cuenta que yo cambié l aquí arriba pero no cambi aquí este ahora este s el locky Aquí dice lo Entonces yo puedo ver los locks que se han generado a través de ese check este Y entonces ustedes ven que ahí el agente de sintético moning ha ido subiendo a loki este toda la serie de eh eh datos internos o datos este respecto a la operación del check este que se pueden obtener que son útiles a la hora de tratar de determinar porque Algo está fallando también entonces Eh sí subimos las dos cosas lo que no subimos de momento que que está pendiente son trazas este definir Qué exactamente Es una traza en el contexto de monitoring es un poco eh No complicado pero subjetivo no depende de cada situación Exacto Entonces está pendiente subir trazas pero de momento no lo estamos haciendo Okay Oye y eh dónde ahorita estoy viendo el tiempo ya tenemos que empezar el ramp down el descenso o como se diga Eso en español eh Y la gente que esté interesada de aprender y jugar más con eh sintéticos eh uno tiene costo podemos empezar a jugar de inmediato como todas las cosas en Grana Cloud Esto está incluido dentro del servicio básico eh No no no no hay costos adicionales eh Los costos en los que las pruebas de sintetic monitoring incurren están estrictamente relacionadas en este momento con la cantidad de series de datos que se generan este las personas que están familiarizadas con grafana Cloud nosotros estamos cobrando por los datos que se almacenan Este Entonces ctic monitoring es Trata de ser muy transparente respecto a Cuántas series de tiempo se van a generar a partir de cada configuración particular de de detic monitoring por ejemplo opción más rápida que tengo aquí hay hay hay un una opción que el usuario puede seleccionar Y entonces bien que pasó de 93 o 261 Entonces entonces siempre y cuando no nos al loquemi ados datos podemos empezar a jugar con él de inmediato sino mucho problema y está la funcionalidad útil de synthetic monitoring está completamente incluida dentro de el el el nivel gratis este el nivel gratis si recuerdan lo que tiene es una retención de datos menor pero eh tod la funcionalidad stic Mon disponible a TR vez de de de la de verdad acabo de hacerlo en este episodio acabo de definir un check para mi para mi página web también y esto no es mi cuenta de grafana es mi cuenta personal y sí ya ya ya lo tengo quieres presumirlo no no está bien Sí ahorita vi la eh posibilidad pero dije yo yo creo que los que nos están viendo vayan echen un ojo se ve bastante transparente bastante directo Cómo puede uno comenzar a configurar este tipo de eh funcionalidades que tenemos en grafana que como ven super útil yo no sé Yo no siento que sintéticos esté teniendo la atención que debería pero es superimportante es algo que eh Cuando tenemos sistemas del que depende Nuestra Empresa O Nuestro proyecto está constantemente trabajando o nos preocupa que no sé ya metieron un cambio y que alguien ya truncó la base de datos y Ah caray Qué pasa es importantísimo detectarlo rápido y emparejarlo con poder hacer ahí el rollback o arreglarlo rápido No sí como como decía eh la funcionalidad más básica la forma más básica de usar synthetic monitoring es muy sencilla de usar tienes que proer un par de parámetros Y eso es todo pero Hay muchísimo espacio para configuraciones más elaboradas más específicas que apuntan en dirección de eh requisitos específicos de cada uno de los usuarios pero si lo que quieren hacer es probar el producto simplemente entender qué es lo que puede hacer entender cómo funciona no necesitan hacer nada muy complicado y como vieron este en 5 minutos ya produce datos sí no fue inmediato me me encantó de dos tres clics Ya estás ahí creando tu primer sintético y realmente prácticamente el de Ping me parece lo más acá directo de está vivo mi servicio y me encantó eso de las ubicaciones que puedas saber cuál es la experiencia nada más de acceder a tu Eh pues recurso tu página o servicio o lo que sea que tengamos depende de dónde estés ubicado no eh increíble Marcelo este Muchísimas gracias por venir aquí a demostrar Cómo se puede hacer todo esto eh antes de pues irnos desp Endo algún otro detalle que quieras mencionar a la audiencia que quieras compartir o que te guste más de los sintéticos los próximos meses vamos a estar anunciando funcionalidad de la que mencioné la posibilidad de trabajar con scripts directamente k a través de syntic mentoring y nosotros siempre agradecemos muchísimo la retroalimentación este con los canales usuales de grafana entonces e cualquier cosa eh que tengan dudas preguntas eh con muchísimo gusto excelente Eh Pues ahí lo tienen este fue Marcelo Magallón eh chéquenlo eh creo que tengo tu linkedin tu kop entonces échenle un ojo si quieren ponerse en contacto también están los canales para que reporten cuál es su experiencia con los sintéticos Nicole vamos a dar rápido los anuncios antes de despedirnos no vamos a tener gr Office hours mañana pero la próxima semana tenemos a Ryan Perry que va a hablar sobre pariscope así que bueno los que ya tenían sus palomitas listas para mañana y sentarse a ver Office hours pueden no sé la nueva serie de Marvel o cualquier cosa y ya el próximo viernes estaremos listos con más Office hours e Marcelo algún último comentario de tu lado anuncio Muchísimas gracias por por el esfuerzo que hacen con este programa me parece que es importantísimo poder hablar de grafana en español sí me encanta gracias por venir Muchas gracias Y también eh Hay unas observability sessions en Madrid que vienen próximamente Déjenme ver Aquí lo tengo el 6 de febrero eh estense preparados Aquí está donde pueden ver más para que asistan en Madrid en español lleno de contenido que este pues la comunidad de habla española pero no podemos ir Leandro noana pues no está muy lejos y las fechas está difícil Nicole y yo no vamos a estar en fos Sí vamos a andar en Bruselas tal vez compartamos un poco de la experiencia veremos qué podemos hacer desde allá o un cafecito para platicar Que qué aprendimos Y cómo vimos todo lo de Bruselas estaría interesante no yao vamos a platicar Qué pasó en Bruselas porque lo que pasa en Bruselas no se queda ahí se comparte con un cafecito e y bueno con eso de nuevo Marcelo muchisísimas gracias por haber venido eh Y pues ya estaremos el próximo episodio eh trayendo más aventuras más eh grafom maníacos No sé eh estense atentos Próximamente lo estaremos avisando y eh También en esas fechas de febrero Que estaremos en fosen Pues no va a haber cafecito porque pues vamos a estar un poco ocupados con eso pero les prometemos traer resumen y lo vamos a platicar aquí para que Eh Pues igual y pueden siguientes años asistir en fosdem que también va a estar muy interesante con eso eh Cerramos el primer cafecito de año Marcelo nicle muchísimas gracias y a todos los que nos estuvieron viendo Feliz año nuevo 2024 y nos vemos la semana que entra cuídense mucho y pues nos estamos viendo pronto adiós nos vemos chao

